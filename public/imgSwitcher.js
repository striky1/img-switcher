"use strict";var __assign=this&&this.__assign||Object.assign||function(t){for(var e,i=1,n=arguments.length;i<n;i++)for(var s in e=arguments[i])Object.prototype.hasOwnProperty.call(e,s)&&(t[s]=e[s]);return t};exports.__esModule=!0;var ImgSwitcher=function(){function I(){this.options={attributes:{breakpoints:"data-img-switcher-bp",lastBreakpoint:"data-img-switcher-lbp",multipliers:"data-img-switcher-mp",targetExtension:"data-img-switcher-te"},breakpoints:[320,640,768,1024,1280,1920],cssClass:"js-img-switcher",cssStyleClass:"o-img-switcher",debug:!1,multiplier:[1,2]}}return I.getInstance=function(){return I.instance||(I.instance=new I),I.instance},I.isResMultiplied=function(t){var e=96*t;return t-=.75,window.matchMedia&&(window.matchMedia("only screen and (min-resolution: "+e+"dpi), only screen and (min-resolution: 2dppx), only screen and (min-resolution: "+e/2.54+"dpcm)").matches||window.matchMedia("only screen and (-webkit-min-device-pixel-ratio: "+t+"), only screen and (-o-min-device-pixel-ratio: "+4*t+"/4), only screen and (min--moz-device-pixel-ratio: "+t+"), only screen and (min-device-pixel-ratio: "+t+")").matches)||window.devicePixelRatio&&window.devicePixelRatio>=t},I.getClosestValueCeil=function(t,e){for(var i=null,n=null,s=0,r=e;s<r.length;s++){var a=r[s];if(t<=a&&null===i){i=a;break}a<t&&(null===n||n<a)&&(n=a)}return null!==i?i:n},I.prototype.initImgSwitcher=function(){this.getImages(),this.getMultiplier(),this.callDebug(["Images: "+this.images,"Multiplier: "+this.multiplier]),this.runImgSwitcher()},I.prototype.runImgSwitcher=function(){var w=this;if(0<this.images.length)for(var t=function(t){var e=y.images[t],i=parseInt(e.getAttribute(y.options.attributes.lastBreakpoint),10),n=e.getAttribute(y.options.attributes.targetExtension)?e.getAttribute(y.options.attributes.targetExtension):null,s=0,r="",a=y.multiplier,o=y.options.breakpoints,l="";if("IMG"===e.tagName?(s=e.parentElement.clientWidth,r=e.getAttribute("src")):"svg"===e.tagName?(s=e.parentElement.clientWidth,r=e.getAttribute("data-src")):(s=e.clientWidth,r=getComputedStyle(e).backgroundImage),null===r||""===r.trim()||"none"===r)return"continue";e.hasAttribute(y.options.attributes.multipliers)&&(a=y.getMultiplier(e.getAttribute(y.options.attributes.multipliers).split(",").map(function(t){return parseInt(t,10)}))),1<a&&(l+="@"+a+"x"),e.hasAttribute(y.options.attributes.breakpoints)&&(o=e.getAttribute(y.options.attributes.breakpoints).split(",").map(function(t){return parseInt(t,10)}));var u,c,p,g,m,d,h,b=I.getClosestValueCeil(s,o);if(i!==b){var f=r.replace("-"+i+l,"").replace(/.([^.]+).?$/g,"-"+b+l+(n?"."+n:r.match(/.([^.]+).?$/g)[0])),v=new Image;e.setAttribute(y.options.attributes.lastBreakpoint,b.toString()),"IMG"===e.tagName?(v.src=f,v.onload=(d=e,h=f,function(){d.setAttribute("src",h),d.classList.remove(w.options.cssStyleClass),v=null})):"svg"===e.tagName?(v.src=f,v.onload=(g=e,m=f,function(){var t=document.createElement("img");t.src=m;for(var e=0;e<g.classList.length;e++)t.classList.add(g.classList[e]);for(t.classList.remove(w.options.cssStyleClass),e=0;e<g.attributes.length;e++){var i=g.attributes.item(e);"data-title"===i.name||"data-alt"===i.name?t.setAttribute(i.name.replace("data-",""),i.nodeValue):0<=i.name.indexOf("data-")&&t.setAttribute(i.nodeName,i.nodeValue)}g.parentNode.insertBefore(t,g),g.remove(),t=v=null})):(f=f.replace("url(","").replace(")","").replace(/"/g,"").replace(/'/g,""),v.src=f,v.onload=(u=e,c=f,p=y.options,function(){u.style.backgroundImage="url("+c+")",u.classList.remove(p.cssStyleClass),v=null})),f=null}},y=this,e=0;e<this.images.length;e++)t(e);else this.callDebug(["Init Error: No images were found!"])},I.prototype.setOptions=function(t){this.options=__assign({},this.options,t)},I.prototype.getImages=function(){return this.images=document.querySelectorAll("."+this.options.cssClass)},I.prototype.getMultiplier=function(t){void 0===t&&(t=this.options.multiplier);var e=1;if(1===t.length)e=t[0];else{t.sort(function(t,e){return e-t});for(var i=0,n=t;i<n.length;i++){var s=n[i];if(I.isResMultiplied(s)){e=s;break}}}return this.multiplier=e},I.prototype.callDebug=function(t){if(this.options.debug)for(var e=0,i=t;e<i.length;e++){var n=i[e];console.log(n)}},I}();exports.ImgSwitcher=ImgSwitcher;